# 五维属性系统详细设计

**版本**: 1.0
**日期**: 2025-11-01

---

## 📊 五维属性定义

### 1. Cognition（认知）[0-1000]
**定义**: 学习能力、知识积累和认知成长

**核心含义**:
- 持续学习的能力
- 知识的广度和深度
- 思维能力的提升

**提升方式**:
- 学习时长（阅读、在线课程、自学等）
- 工作时长（专业技能应用）
- 参加知识类活动（讲座、读书会、工作坊）
- 完成认知类挑战

---

### 2. Sociability（社交）[0-1000]
**定义**: 社交活跃度和人际连接能力

**核心含义**:
- 主动建立社交连接的意愿
- 社交互动的频率和质量
- 社交网络的广度

**提升方式**:
- 添加新好友
- 参加社交活动
- 发起/参与互动（聊天、评论）
- 组织活动
- 帮助其他会员

---

### 3. Charisma（魅力）[0-1000]
**定义**: 个人影响力和受欢迎程度

**核心含义**:
- 被他人认可的程度
- 个人魅力和吸引力
- 对他人的正面影响

**提升方式**:
- 收到他人点赞
- 收到正面评价/留言
- 内容被分享
- 被添加为好友（被动）
- 活动参与人数（作为组织者）

---

### 4. Vitality（活力）[0-1000]
**定义**: 身体健康和精力充沛度

**核心含义**:
- 身体健康状况
- 精力和体能水平
- 生活规律性

**提升方式**:
- 签到打卡（体现规律性）
- 运动时长和频率
- 睡眠质量记录
- 健康饮食记录
- 参加运动类活动

---

### 5. Reflection（自省）[0-1000]
**定义**: 自我觉察和内心成长

**核心含义**:
- 情绪感知能力
- 自我反思的习惯
- 内心平静和觉察

**提升方式**:
- 心情记录（每日心情打卡）
- 日记/反思记录
- 冥想打卡
- 目标设定和复盘
- 参加自省类活动（冥想课、心理工作坊）

---

## 🧮 属性计算逻辑

### 计算原则
1. **实时更新**: 用户行为发生后立即计算并更新
2. **公平性**: 防止刷分，设置每日上限
3. **衰减机制**: 长期不活跃，属性缓慢衰减
4. **激励导向**: 鼓励多样化行为，而非单一行为

---

### Cognition（认知）计算规则

#### 行为类型与增加值

| 行为 | 增加值 | 每日上限 | 备注 |
|------|--------|----------|------|
| 学习时长（每10分钟） | +3 | 180次（30小时） | 在ORA空间学习区记录 |
| 工作时长（每10分钟） | +2 | 120次（20小时） | 专注工作模式 |
| 阅读打卡（每次） | +15 | 3次 | 需记录阅读内容 |
| 完成在线课程（每节） | +30 | 5次 | 关联学习平台 |
| 参加知识讲座 | +50 | 2次 | 线下活动 |
| 参加读书会 | +40 | 2次 | 线下活动 |
| 分享学习笔记 | +20 | 3次 | 质量审核 |
| 获得知识类徽章 | +100 | - | 成就解锁 |

#### 计算公式
```
每日 Cognition 增量 = Σ(各行为增加值)
总 Cognition = 历史累积值 + 每日增量 - 衰减值
```

#### 衰减机制
- **触发条件**: 连续 7 天无任何 Cognition 相关行为
- **衰减率**: 每天 -1%（从第8天开始）
- **最低值**: 不低于 100

**示例**:
```
用户当前 Cognition = 500
连续 10 天未学习：
Day 8: 500 × 0.99 = 495
Day 9: 495 × 0.99 = 490.05
Day 10: 490.05 × 0.99 = 485.15
```

---

### Sociability（社交）计算规则

#### 行为类型与增加值

| 行为 | 增加值 | 每日上限 | 备注 |
|------|--------|----------|------|
| 添加新好友 | +15 | 10次 | 主动添加 |
| 接受好友请求 | +5 | 20次 | 被动接受 |
| 发起对话（每次） | +5 | 20次 | 有效对话（>3轮） |
| 回复他人消息 | +3 | 30次 | 及时回复（<1小时） |
| 参加社交活动 | +50 | 3次 | 线下活动 |
| 组织活动 | +80 | 2次 | 作为主办方 |
| 发表动态/分享 | +10 | 5次 | 高质量内容 |
| 评论互动 | +5 | 20次 | 有效评论 |
| 在线下空间社交（每30分钟） | +8 | 16次（8小时） | 位置检测 |
| 获得社交类徽章 | +100 | - | 成就解锁 |

#### 质量权重
社交行为的质量影响增加值：
- **有效对话**: 对话轮数 ≥ 3 轮，时长 ≥ 5 分钟
- **高质量内容**: 收到点赞/评论数量
  - 10+ 互动: × 1.5
  - 50+ 互动: × 2.0

#### 衰减机制
- **触发条件**: 连续 5 天无社交行为
- **衰减率**: 每天 -1.5%
- **最低值**: 不低于 50

---

### Charisma（魅力）计算规则

#### 行为类型与增加值

| 行为 | 增加值 | 每日上限 | 备注 |
|------|--------|----------|------|
| 收到点赞（每个） | +3 | 100次 | 来自不同用户 |
| 收到评论 | +5 | 50次 | 有效评论 |
| 收到感谢/表扬 | +15 | 10次 | 正面反馈 |
| 内容被分享 | +20 | 20次 | 分享到其他平台 |
| 被添加为好友（被动） | +10 | 15次 | 被他人主动添加 |
| 组织活动（按参与人数） | +5/人 | 200点 | 最多40人 |
| 成为每周/月度榜单前10 | +100 | - | 排行榜奖励 |
| 获得魅力类徽章 | +150 | - | 成就解锁 |
| 被推荐给新用户 | +25 | 10次 | 系统推荐 |

#### 特殊机制：魅力值更依赖他人
- **他人贡献**: Charisma 的 80% 来自他人行为（点赞、评论、添加等）
- **自身贡献**: 仅 20% 来自自身行为（发布内容、组织活动）

#### 质量权重
- **真实互动**: 来自活跃用户的点赞权重更高
  - 活跃用户（周活跃）: × 1.0
  - 一般用户: × 0.5
  - 新用户: × 0.3
- **防止刷分**: 同一用户对同一内容的重复点赞不计分

#### 衰减机制
- **触发条件**: 连续 3 天未收到任何正面反馈
- **衰减率**: 每天 -2%（魅力值更易流失）
- **最低值**: 不低于 50

---

### Vitality（活力）计算规则

#### 行为类型与增加值

| 行为 | 增加值 | 每日上限 | 备注 |
|------|--------|----------|------|
| 每日签到 | +10 | 1次 | 基础奖励 |
| 连续签到奖励 | +5/天 | - | 累加（如第7天+35） |
| 运动时长（每10分钟） | +5 | 72次（12小时） | 运动模式追踪 |
| 记录睡眠（7-9小时） | +20 | 1次 | 优质睡眠 |
| 记录睡眠（<6 或 >10小时） | +5 | 1次 | 非最佳睡眠 |
| 健康饮食打卡 | +10 | 3次 | 早/午/晚餐 |
| 参加运动活动 | +60 | 2次 | 线下运动课程 |
| 达到每日步数目标（8000步） | +15 | 1次 | 步数追踪 |
| 完成体能挑战 | +80 | 1次 | 特殊挑战 |
| 获得活力类徽章 | +120 | - | 成就解锁 |

#### 连续签到奖励
```
Day 1: +10
Day 2: +10 + 5 = +15
Day 3: +10 + 10 = +20
...
Day 7: +10 + 30 = +40
Day 8: 重置到 +10（或继续累加，设计待定）
```

#### 健康评分系统
Vitality 的计算考虑**规律性**和**健康度**：
- **规律性**: 连续天数越多，奖励越高
- **健康度**: 睡眠、饮食、运动的平衡
  - 三者都有记录: × 1.2 加成
  - 仅一项: × 0.8 折扣

#### 衰减机制
- **触发条件**: 连续 2 天未签到
- **衰减率**: 每天 -1%
- **最低值**: 不低于 80

---

### Reflection（自省）计算规则

#### 行为类型与增加值

| 行为 | 增加值 | 每日上限 | 备注 |
|------|--------|----------|------|
| 每日心情记录 | +15 | 1次 | 简单心情选择 |
| 日记/反思记录（>50字） | +25 | 3次 | 深度反思 |
| 日记/反思记录（>200字） | +40 | 2次 | 高质量反思 |
| 冥想打卡（每10分钟） | +8 | 12次（2小时） | 冥想模式 |
| 设定目标 | +20 | 3次 | 每周/月目标 |
| 完成目标复盘 | +30 | 3次 | 目标回顾 |
| 参加冥想/正念课程 | +50 | 2次 | 线下活动 |
| 参加心理工作坊 | +60 | 2次 | 线下活动 |
| 获得自省类徽章 | +100 | - | 成就解锁 |

#### 质量评估
日记/反思的质量通过以下因素评估：
- **字数**: 越长，质量越高（但设上限避免刷字数）
- **频率**: 每日 1-3 次为最佳，过多不加分
- **情感丰富度**: 使用情感词汇（可选，LLM辅助分析）

#### 深度加成
如果日记内容体现深度思考，可获得额外加成：
- **有明确反思**: +10（如"我意识到..."）
- **有行动计划**: +10（如"明天我会..."）
- **情感表达丰富**: +5

**示例**:
```
普通日记（50字）: +25
深度日记（200字 + 反思 + 行动计划）: +40 + 10 + 10 = +60
```

#### 衰减机制
- **触发条件**: 连续 3 天无自省行为
- **衰减率**: 每天 -1%
- **最低值**: 不低于 50

---

## 📈 属性等级划分

每个属性根据分数划分等级，影响徽章和称号。

| 等级 | 分数范围 | 称号 | 颜色 |
|------|----------|------|------|
| Lv 0 | 0-49 | 初学者 (Novice) | 灰色 |
| Lv 1 | 50-149 | 入门者 (Beginner) | 白色 |
| Lv 2 | 150-299 | 进阶者 (Intermediate) | 绿色 |
| Lv 3 | 300-499 | 熟练者 (Skilled) | 蓝色 |
| Lv 4 | 500-699 | 专家 (Expert) | 紫色 |
| Lv 5 | 700-899 | 大师 (Master) | 金色 |
| Lv 6 | 900-1000 | 传奇 (Legendary) | 红色 |

### 等级称号示例
- **Cognition Lv5**: 智慧大师 (Wisdom Master)
- **Sociability Lv5**: 社交达人 (Social Master)
- **Charisma Lv5**: 魅力领袖 (Charisma Leader)
- **Vitality Lv5**: 活力之星 (Vitality Star)
- **Reflection Lv5**: 觉察大师 (Mindfulness Master)

---

## 🎯 综合评分与会员等级

### 综合评分
```
综合评分 = (Cognition + Sociability + Charisma + Vitality + Reflection) / 5
```

### 会员等级（基于综合评分）

| 会员等级 | 综合评分 | 权益 |
|----------|----------|------|
| 青铜会员 | 0-149 | 基础权益 |
| 白银会员 | 150-299 | 9折优惠 |
| 黄金会员 | 300-499 | 8折优惠 + 专属活动 |
| 铂金会员 | 500-699 | 7折优惠 + 优先权 |
| 钻石会员 | 700-899 | 5折优惠 + VIP服务 |
| 传奇会员 | 900-1000 | 全免费 + 专属特权 |

---

## 🔄 属性平衡与调优

### 平衡原则
1. **五维均衡发展**: 鼓励用户全面成长，而非只专注一维
2. **防止单一刷分**: 设置每日上限和衰减机制
3. **长期激励**: 连续行为和习惯养成获得更高奖励
4. **质量优先**: 高质量行为比高频次行为奖励更多

### 调优策略
- **A/B测试**: 测试不同增加值的效果
- **数据分析**: 监控用户行为模式，调整参数
- **用户反馈**: 收集用户对公平性的反馈
- **定期审查**: 每季度审查并调整计算规则

---

## 🛡️ 防作弊机制

### 1. 行为验证
- **时长验证**: 学习/运动时长需通过设备传感器验证（如手机锁屏则暂停）
- **位置验证**: 线下活动需通过GPS定位验证
- **互动验证**: 社交互动需双方确认

### 2. 异常检测
- **频率异常**: 短时间内大量重复行为标记为异常
- **设备检测**: 同一设备多账号行为检测
- **模式识别**: 使用机器学习识别刷分模式

### 3. 惩罚机制
- **警告**: 首次异常行为警告
- **扣分**: 第二次扣除相应属性值
- **封禁**: 严重作弊行为封禁账号

---

## 💾 数据存储与API

### 数据库设计

#### attributes 表
```sql
CREATE TABLE attributes (
    user_id UUID PRIMARY KEY REFERENCES users(user_id),
    cognition INT DEFAULT 100,
    sociability INT DEFAULT 100,
    charisma INT DEFAULT 100,
    vitality INT DEFAULT 100,
    reflection INT DEFAULT 100,
    cognition_level INT DEFAULT 1,
    sociability_level INT DEFAULT 1,
    charisma_level INT DEFAULT 1,
    vitality_level INT DEFAULT 1,
    reflection_level INT DEFAULT 1,
    overall_score INT GENERATED ALWAYS AS (
        (cognition + sociability + charisma + vitality + reflection) / 5
    ) STORED,
    last_updated TIMESTAMP DEFAULT NOW(),
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### attribute_logs 表（行为日志）
```sql
CREATE TABLE attribute_logs (
    log_id UUID PRIMARY KEY,
    user_id UUID REFERENCES users(user_id),
    attribute_type VARCHAR(20), -- 'cognition', 'sociability', etc.
    action_type VARCHAR(50), -- 'study', 'add_friend', 'like', etc.
    value_change INT, -- +15, +20, etc.
    metadata JSONB, -- 额外信息（如时长、内容等）
    created_at TIMESTAMP DEFAULT NOW()
);
```

#### daily_limits 表（每日限额追踪）
```sql
CREATE TABLE daily_limits (
    user_id UUID,
    action_type VARCHAR(50),
    count INT DEFAULT 0,
    date DATE DEFAULT CURRENT_DATE,
    PRIMARY KEY (user_id, action_type, date)
);
```

### API 接口

#### 1. 获取用户属性
```http
GET /api/v1/attributes/{user_id}

Response:
{
  "user_id": "uuid",
  "attributes": {
    "cognition": { "value": 450, "level": 3 },
    "sociability": { "value": 320, "level": 3 },
    "charisma": { "value": 280, "level": 2 },
    "vitality": { "value": 510, "level": 4 },
    "reflection": { "value": 390, "level": 3 }
  },
  "overall_score": 390,
  "member_level": "黄金会员",
  "last_updated": "2025-11-01T14:30:00Z"
}
```

#### 2. 记录行为（增加属性）
```http
POST /api/v1/attributes/action

Request:
{
  "user_id": "uuid",
  "action_type": "study",
  "duration": 60, // 分钟
  "metadata": {
    "location": "ORA Space",
    "activity": "reading"
  }
}

Response:
{
  "success": true,
  "attribute": "cognition",
  "value_change": +18,
  "new_value": 468,
  "message": "学习60分钟，认知 +18"
}
```

#### 3. 获取属性历史
```http
GET /api/v1/attributes/{user_id}/history?days=7

Response:
{
  "user_id": "uuid",
  "period": "7 days",
  "history": [
    {
      "date": "2025-11-01",
      "cognition": 450,
      "sociability": 320,
      ...
    },
    ...
  ],
  "changes": {
    "cognition": +45,
    "sociability": +60,
    ...
  }
}
```

#### 4. 批量更新（WebSocket推送）
```json
// WebSocket Message
{
  "type": "attribute_update",
  "user_id": "uuid",
  "updates": [
    {
      "attribute": "vitality",
      "value_change": +10,
      "new_value": 520,
      "reason": "每日签到"
    }
  ],
  "timestamp": "2025-11-01T09:00:00Z"
}
```

---

## 🧪 测试与迭代

### 测试阶段计划

#### Alpha 测试（内部）
- **目标**: 验证计算逻辑正确性
- **参与者**: 10-20人内部团队
- **时长**: 2周
- **关注点**:
  - 属性增长速度是否合理
  - 每日上限是否合适
  - 衰减机制是否有效

#### Beta 测试（小范围）
- **目标**: 收集真实用户反馈
- **参与者**: 100-200人种子用户
- **时长**: 4周
- **关注点**:
  - 用户参与度
  - 属性增长曲线
  - 作弊行为检测
  - 用户满意度

#### 调整参数
根据测试数据调整：
- 增加值大小
- 每日上限
- 衰减率
- 质量权重

---

## 📝 总结

五维属性系统是 ORA 生态的核心，通过科学的计算逻辑和激励机制：
1. **量化成长**: 让用户看到可见的成长
2. **引导行为**: 鼓励全面发展和持续习惯
3. **防止作弊**: 确保公平性和真实性
4. **持续优化**: 基于数据不断调整和改进

**下一步**: 基于五维属性设计 ExplORA 游戏中的 LLM 决策机制。

---

**最后更新**: 2025-11-01
